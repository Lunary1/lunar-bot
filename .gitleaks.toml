# gitleaks configuration
# https://github.com/gitleaks/gitleaks
title = "LunarBot Gitleaks Config"

[extend]
# Use the default ruleset as base
useDefault = true

[[rules]]
id = "supabase-url-hardcoded"
description = "Hardcoded Supabase project URL"
regex = '''https://[a-z]{20}\.supabase\.co'''
tags = ["supabase", "secret"]

[[rules]]
id = "supabase-anon-jwt"
description = "Supabase anon/service JWT token hardcoded"
regex = '''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\.[a-zA-Z0-9_-]{50,}'''
tags = ["jwt", "supabase", "secret"]

[allowlist]
description = "Global allowlist"
# Allow env.example â€” it must only contain placeholder values, never real credentials
paths = [
  '''^env\.example$''',
  '''^\.gitleaks\.toml$''',
  '''^docs/.*\.md$''',
]
# Allow placeholder strings
regexes = [
  '''your_supabase_project_url''',
  '''your_supabase_anon_key''',
  '''your_.*_key''',
]
